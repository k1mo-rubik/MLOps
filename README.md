

# Проект: MLOps с использованием ONNX и Gradio

## Описание проекта

Этот проект демонстрирует основные этапы MLOps-процесса:

- Структурирование кода для машинного обучения.
- Экспорт модели в формате ONNX для повышения совместимости и производительности.
- Разработка веб-приложения с использованием фреймворка Gradio для взаимодействия с моделью.

Приложение принимает изображения на вход, выполняет инференс с использованием модели ONNX и возвращает текстовую метку предсказанного класса.

## Установка

1. **Клонирование репозитория**:

   ```bash
   git clone https://github.com/k1mo-rubik/MLOps.git
   cd mlops
   ```

2. **Создание виртуального окружения (опционально)**:

   ```bash
   python -m venv venv
   source venv/bin/activate  # Для Linux/MacOS
   venv\Scripts\activate  # Для Windows
   ```

3. **Установка зависимостей**:
   Убедитесь, что у вас установлен Python версии 3.8 или выше.

   ```bash
   pip install -r requirements.txt
   ```

4. **Установка библиотек для работы с GPU в случае, если они не установились **:

   ```bash
   pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu124
   ```

## Запуск веб-приложения

1. Перейдите в директорию с приложением:

   ```bash
   cd app
   ```

2. Запустите приложение:

   ```bash
   python app.py
   ```

3. Откройте браузер и перейдите по адресу:

   ```
   http://localhost:7860
   ```

4. Загрузите изображение через интерфейс приложения, чтобы получить предсказание.

## Структура проекта

```
├── LICENSE            <- Open-source license if one is chosen
├── Makefile           <- Makefile with convenience commands like `make data` or `make train`
├── README.md          <- The top-level README for developers using this project.
├── data                   <- Данные для обучения и тестирования.
├── models                 <- Сохраненные обученные модели.
├── notebooks              <- Jupyter-ноутбуки с экспериментами.
│   ├── Fine_Tune.ipynb    <- Исходный ноутбук проекта по дообучению модели распознавания
│   └── ft_lite.ipynb      <- обновленный и оптимизированный ноутбук под настоящий проект
├── mlops_lukianenko       <- Исходный код проекта.
│   ├── dataset.py         <- Код для загрузки и обработки данных.
│   ├── features.py        <- Генерация признаков для модели.
│   ├── modeling           <- Код для обучения и инференса модели.
│   │   ├── train.py       <- Скрипт для обучения модели.
│   │   └── predict.py     <- Код для инференса модели.
├── app                    <- Веб-приложение Gradio.
│   └── app.py             <- Основной скрипт для запуска веб-приложения.
├── requirements.txt       <- Список зависимостей.
└── README.md              <- Документация проекта.
```

## Примечания

- Убедитесь, что модель `trained_model.onnx` находится в `/app` директории проекта или укажите её путь в `app.py`.
- Для тестирования можно использовать любое изображение, совместимое с вашей моделью.

